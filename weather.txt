	if(command === 'weather') {
    if(`${args[0]}` === 'undefined') {
      db.get(`${tags.username}time`).then(function(value) {
        let usercitycountry = `${value}`
        if(usercitycountry === 'null') {
          client.say(channel, `${tags.username}, Before using this command, you must set your location with the !setlocation command. Example: â€œ!setlocation lasalle ontarioâ€, â€œ!setlocation springfield virginiaâ€ or â€œ!setlocation stockholm swedenâ€. More info: https://darkvypr.com/commands`)
        }
        else {
          axios.get(`https://geocode.search.hereapi.com/v1/geocode?q=${usercitycountry}&apiKey=${process.env['GEOCODING_KEY']}`)
          .then((response) => {
            let unparsedcoords = response.data
            let parsedcoordslat = `${unparsedcoords.items[0].position.lat}`
            let parsedcoordslong = `${unparsedcoords.items[0].position.lng}`
            let namefromapi = `${unparsedcoords.items[0].title}`
            

          axios.get(`http://api.openweathermap.org/data/2.5/weather?lat=${parsedcoordslat}&lon=${parsedcoordslong}&units=metric&appid=${process.env['WEATHER_KEY']}`)
          .then((response) => {
            let weatherresults = response.data
            let checkcondition = `${weatherresults.weather[0].main}`
            let checkicon = `${weatherresults.weather[0].icon}`
            let weatherdescription = `${weatherresults.weather[0].description}`

            if(checkcondition === 'Clear') {
              let checkedcondition = 'with clear skies â˜€ï¸ğŸŒ‡'
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkcondition === 'Thunderstorm') {
              let checkedcondition = `with a ${weatherdescription} â›ˆï¸â˜”`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkcondition === 'Drizzle') {
              let checkedcondition = 'with slight rain ğŸŒ¦ï¸ğŸŒ§ï¸'
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkcondition === 'Rain') {
              let checkedcondition = `with ${weatherdescription} ğŸŒ§ï¸â˜”`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkcondition === 'Snow') {
              let checkedcondition = `with ${weatherdescription} ğŸŒ¨ï¸â„ï¸`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkcondition === 'Clouds') {
              let checkedcondition = `with ${weatherdescription} â˜ï¸ğŸŒ¥ï¸`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
            else if(checkicon === '50d' || checkicon === '50n') {
              let checkedcondition = `with a special weather event: ${weatherdescription} ğŸ”`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
            }
          });
          });
        }
      })
    }

    else {
      let specificlocation = `${args.join(' ')}`
      if(specificlocation[0] === '@') {
        let removedatsign = specificlocation[0].replace('@', '') + specificlocation.substring(1)
        let removedatsignlow = removedatsign.toLowerCase()
		    db.get(`${removedatsignlow}time`).then(function(value) {
			    let lookuptime = `${value}`
          if(lookuptime === 'null') {
            client.say(channel, (`${tags.username}, That user hasen't set their location! Get them to set it and retry. PANIC`))
		      }
          else {
            axios.get(`https://geocode.search.hereapi.com/v1/geocode?q=${lookuptime}&apiKey=${process.env['GEOCODING_KEY']}`)
            .then((response) => {
              let unparsedcoords = response.data
              let parsedcoordslat = `${unparsedcoords.items[0].position.lat}`
              let parsedcoordslong = `${unparsedcoords.items[0].position.lng}`
              let namefromapi = `${unparsedcoords.items[0].title}`

           axios.get(`http://api.openweathermap.org/data/2.5/weather?lat=${parsedcoordslat}&lon=${parsedcoordslong}&units=metric&appid=${process.env['WEATHER_KEY']}`)
            .then((response) => {
             let weatherresults = response.data
             let checkcondition = `${weatherresults.weather[0].main}`
             let checkicon = `${weatherresults.weather[0].icon}`
             let weatherdescription = `${weatherresults.weather[0].description}`

             if(checkcondition === 'Clear') {
               let checkedcondition = 'with clear skies â˜€ï¸ğŸŒ‡'
               client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
             }
             else if(checkcondition === 'Thunderstorm') {
                let checkedcondition = `with a ${weatherdescription} â›ˆï¸â˜”`
                client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
              else if(checkcondition === 'Drizzle') {
                let checkedcondition = 'with slight rain ğŸŒ¦ï¸ğŸŒ§ï¸'
                client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
              else if(checkcondition === 'Rain') {
                let checkedcondition = `with ${weatherdescription} ğŸŒ§ï¸â˜”`
               client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
              else if(checkcondition === 'Snow') {
                let checkedcondition = `with ${weatherdescription} ğŸŒ¨ï¸â„ï¸`
                client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
              else if(checkcondition === 'Clouds') {
                let checkedcondition = `with ${weatherdescription} â˜ï¸ğŸŒ¥ï¸`
                client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
              else if(checkicon === '50d' || checkicon === '50n') {
                let checkedcondition = `with a special weather event: ${weatherdescription} ğŸ”`
                client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
              }
            });
            });
          }
        })
      }

      else {
        axios.get(`https://geocode.search.hereapi.com/v1/geocode?q=${args.join(' ')}&apiKey=${process.env['GEOCODING_KEY']}`)
          .then((response) => {
            let unparsedcoords = response.data
            let parsedcoordslat = `${unparsedcoords.items[0].position.lat}`
            let parsedcoordslong = `${unparsedcoords.items[0].position.lng}`
            let namefromapi = `${unparsedcoords.items[0].title}`

        axios.get(`http://api.openweathermap.org/data/2.5/weather?lat=${parsedcoordslat}&lon=${parsedcoordslong}&units=metric&appid=${process.env['WEATHER_KEY']}`)
        .then((response) => {
          let weatherresults = response.data
          let checkcondition = `${weatherresults.weather[0].main}`
          let checkicon = `${weatherresults.weather[0].icon}`
          let weatherdescription = `${weatherresults.weather[0].description}`

          if(checkcondition === 'Clear') {
            let checkedcondition = 'with clear skies â˜€ï¸ğŸŒ‡'
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkcondition === 'Thunderstorm') {
            let checkedcondition = `with a ${weatherdescription} â›ˆï¸â˜”`
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkcondition === 'Drizzle') {
            let checkedcondition = 'with slight rain ğŸŒ¦ï¸ğŸŒ§ï¸'
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkcondition === 'Rain') {
            let checkedcondition = `with ${weatherdescription} ğŸŒ§ï¸â˜”`
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkcondition === 'Snow') {
            let checkedcondition = `with ${weatherdescription} ğŸŒ¨ï¸â„ï¸`
              client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkcondition === 'Clouds') {
            let checkedcondition = `with ${weatherdescription} â˜ï¸ğŸŒ¥ï¸`
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
          else if(checkicon === '50d' || checkicon === '50n') {
            let checkedcondition = `with a special weather event: ${weatherdescription} ğŸ”`
            client.say(channel, `${tags.username}, The temperature in ${namefromapi} is currently ${weatherresults.main.temp}Â°C (Feels like: ${weatherresults.main.feels_like}Â°C) ${checkedcondition}. Wind speed: ${weatherresults.wind.speed} meters/s. ğŸ’¨ Humidity: ${weatherresults.main.humidity}% ğŸ’§`)
          }
        });
        });
      }
    }
  }
